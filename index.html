<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNS Visualisierung - Interaktive Demo</title>
    <meta name="description" content="Interaktive DNS-Visualisierung - Lerne wie Domain Name System funktioniert">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-ring {
            0% { transform: scale(0.95); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.7; }
            100% { transform: scale(0.95); opacity: 1; }
        }
        .animate-pulse-ring {
            animation: pulse-ring 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const DNSVisualization = () => {
          const [domain, setDomain] = useState('');
          const [step, setStep] = useState(-1);
          const [isPlaying, setIsPlaying] = useState(false);
          const [generatedIP, setGeneratedIP] = useState('');

          const generateRandomIP = () => {
            return `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
          };

          const parseDomain = (domain) => {
            const parts = domain.toLowerCase().replace('https://', '').replace('http://', '').replace('www.', '').split('.');
            if (parts.length < 2) return null;
            
            return {
              subdomain: 'www',
              domain: parts[0],
              tld: parts[parts.length - 1]
            };
          };

          const parsed = domain ? parseDomain(domain) : null;

          const servers = [
            { id: 0, name: 'Dein Computer', color: 'bg-blue-500', x: 100, y: 450, size: 'large' },
            { id: 1, name: 'DNS-Resolver', color: 'bg-purple-500', x: 250, y: 300, size: 'medium' },
            { id: 2, name: 'Root DNS', color: 'bg-red-500', x: 450, y: 150, size: 'large' },
            { id: 3, name: `TLD (.${parsed?.tld || 'com'})`, color: 'bg-orange-500', x: 650, y: 200, size: 'medium' },
            { id: 4, name: 'Nameserver', color: 'bg-green-500', x: 750, y: 350, size: 'medium' }
          ];

          const connections = [
            { from: 0, to: 1, step: 1, color: '#FFD700' },
            { from: 1, to: 2, step: 2, color: '#FFD700' },
            { from: 2, to: 3, step: 3, color: '#FFD700' },
            { from: 3, to: 4, step: 4, color: '#FFD700' },
            { from: 4, to: 1, step: 5, color: '#00FF00' },
            { from: 1, to: 0, step: 6, color: '#00FF00' }
          ];

          const steps = [
            {
              id: 0,
              title: '1Ô∏è‚É£ Start',
              description: `Du gibst "${domain}" ein`,
              detail: 'Dein Browser startet die DNS-Anfrage',
              emoji: 'üíª',
              serverHighlight: 0
            },
            {
              id: 1,
              title: '2Ô∏è‚É£ DNS-Resolver',
              description: 'Anfrage an lokalen DNS',
              detail: `Der Resolver pr√ºft seinen Cache. "${domain}" nicht gefunden ‚Üí Frage Root-Server`,
              emoji: 'üîç',
              serverHighlight: 1
            },
            {
              id: 2,
              title: '3Ô∏è‚É£ Root DNS',
              description: 'Frage an Root-Server',
              detail: `Root-Server: "F√ºr .${parsed?.tld} ist dieser TLD-Server zust√§ndig"`,
              emoji: 'üåç',
              serverHighlight: 2
            },
            {
              id: 3,
              title: '4Ô∏è‚É£ TLD-Server',
              description: 'Frage an TLD-Server',
              detail: `TLD-Server: "${parsed?.domain}.${parsed?.tld} wird hier verwaltet"`,
              emoji: 'üè¢',
              serverHighlight: 3
            },
            {
              id: 4,
              title: '5Ô∏è‚É£ Nameserver',
              description: 'Finale Anfrage',
              detail: `Nameserver antwortet: "${domain} ‚Üí ${generatedIP}"`,
              emoji: '‚úÖ',
              serverHighlight: 4
            },
            {
              id: 5,
              title: '6Ô∏è‚É£ R√ºckweg',
              description: 'IP-Adresse zur√ºck',
              detail: `Antwort wird zur√ºckgesendet: ${generatedIP}`,
              emoji: '‚Ü©Ô∏è',
              serverHighlight: 1
            },
            {
              id: 6,
              title: '7Ô∏è‚É£ Fertig!',
              description: 'Verbindung hergestellt',
              detail: `Browser l√§dt ${domain} von ${generatedIP}`,
              emoji: 'üéâ',
              serverHighlight: 0
            }
          ];

          const startDemo = () => {
            if (!domain) {
              alert('Bitte gib eine Domain ein!');
              return;
            }
            setStep(0);
            setGeneratedIP(generateRandomIP());
            setIsPlaying(false);
          };

          const nextStep = () => {
            if (step < steps.length - 1) {
              setStep(step + 1);
            }
          };

          const prevStep = () => {
            if (step > 0) {
              setStep(step - 1);
            }
          };

          const autoPlay = () => {
            if (!isPlaying && step >= 0) {
              setIsPlaying(true);
              let currentStep = step;
              const interval = setInterval(() => {
                currentStep++;
                if (currentStep >= steps.length) {
                  setIsPlaying(false);
                  clearInterval(interval);
                } else {
                  setStep(currentStep);
                }
              }, 2500);
            }
          };

          const reset = () => {
            setStep(-1);
            setDomain('');
            setGeneratedIP('');
            setIsPlaying(false);
          };

          const setExampleDomain = (example) => {
            if (step < 0) {
              setDomain(example);
            }
          };

          return (
            <div className="w-full min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 p-4 md:p-8">
              <div className="max-w-7xl mx-auto">
                <h1 className="text-4xl md:text-6xl font-bold text-white mb-4 text-center drop-shadow-lg">
                  üåê DNS Visualisierung
                </h1>

                <div className="bg-white rounded-3xl shadow-2xl p-6 md:p-8 mb-6">
                  <label className="text-gray-800 font-bold mb-3 block text-xl">
                    üîó Website eingeben:
                  </label>
                  <div className="flex gap-4 flex-col md:flex-row mb-3">
                    <input
                      type="text"
                      value={domain}
                      onChange={(e) => setDomain(e.target.value)}
                      placeholder="z.B. google.com"
                      className="flex-1 px-6 py-4 rounded-2xl text-xl font-mono bg-gray-100 border-4 border-gray-300 focus:border-blue-500 outline-none"
                      disabled={step >= 0}
                    />
                    <button
                      onClick={startDemo}
                      disabled={step >= 0}
                      className="bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white px-8 py-4 rounded-2xl font-bold text-lg transition shadow-xl"
                    >
                      üöÄ Start
                    </button>
                  </div>

                  {step < 0 && (
                    <div className="flex gap-2 flex-wrap">
                      <button onClick={() => setExampleDomain('google.com')} className="bg-blue-100 hover:bg-blue-200 px-4 py-2 rounded-lg text-sm font-semibold transition">
                        google.com
                      </button>
                      <button onClick={() => setExampleDomain('youtube.de')} className="bg-red-100 hover:bg-red-200 px-4 py-2 rounded-lg text-sm font-semibold transition">
                        youtube.de
                      </button>
                      <button onClick={() => setExampleDomain('wikipedia.org')} className="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg text-sm font-semibold transition">
                        wikipedia.org
                      </button>
                      <button onClick={() => setExampleDomain('amazon.de')} className="bg-orange-100 hover:bg-orange-200 px-4 py-2 rounded-lg text-sm font-semibold transition">
                        amazon.de
                      </button>
                      <button onClick={() => setExampleDomain('github.com')} className="bg-purple-100 hover:bg-purple-200 px-4 py-2 rounded-lg text-sm font-semibold transition">
                        github.com
                      </button>
                    </div>
                  )}

                  {parsed && step < 0 && (
                    <div className="mt-4 bg-green-100 border-4 border-green-400 rounded-xl p-4">
                      <div className="grid grid-cols-3 gap-3 text-center">
                        <div>
                          <p className="text-xs text-gray-600">Subdomain</p>
                          <p className="font-mono font-bold text-blue-600">{parsed.subdomain}</p>
                        </div>
                        <div>
                          <p className="text-xs text-gray-600">Domain</p>
                          <p className="font-mono font-bold text-purple-600">{parsed.domain}</p>
                        </div>
                        <div>
                          <p className="text-xs text-gray-600">TLD</p>
                          <p className="font-mono font-bold text-orange-600">.{parsed.tld}</p>
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {step >= 0 && (
                  <div className="bg-white/95 rounded-2xl shadow-2xl p-4 mb-6">
                    <div className="flex gap-3 flex-wrap justify-center">
                      {step > 0 && (
                        <button
                          onClick={prevStep}
                          disabled={isPlaying}
                          className="bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white px-5 py-3 rounded-xl font-bold transition"
                        >
                          ‚Üê Zur√ºck
                        </button>
                      )}
                      
                      {step < steps.length - 1 && (
                        <button
                          onClick={nextStep}
                          disabled={isPlaying}
                          className="bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white px-8 py-3 rounded-xl font-bold text-lg transition shadow-lg"
                        >
                          Weiter ‚Üí
                        </button>
                      )}

                      {step < steps.length - 1 && (
                        <button
                          onClick={autoPlay}
                          disabled={isPlaying}
                          className="bg-purple-500 hover:bg-purple-600 disabled:bg-purple-300 text-white px-5 py-3 rounded-xl font-bold transition"
                        >
                          ‚ñ∂ Auto
                        </button>
                      )}

                      <button
                        onClick={reset}
                        className="bg-red-500 hover:bg-red-600 text-white px-5 py-3 rounded-xl font-bold transition"
                      >
                        ‚Üª Neu
                      </button>
                    </div>
                  </div>
                )}

                <div className="grid md:grid-cols-2 gap-6">
                  <div className="bg-white/95 rounded-3xl shadow-2xl p-6 order-2 md:order-1">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 text-center">üìä Netzwerk-Diagramm</h2>
                    
                    <div className="relative bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-4" style={{ height: '550px' }}>
                      <svg className="absolute inset-0 w-full h-full" viewBox="0 0 900 600">
                        {connections.map((conn, idx) => {
                          const fromServer = servers[conn.from];
                          const toServer = servers[conn.to];
                          const isActive = step >= conn.step;
                          const isCurrent = step === conn.step;
                          
                          return (
                            <g key={idx}>
                              <line
                                x1={fromServer.x}
                                y1={fromServer.y}
                                x2={toServer.x}
                                y2={toServer.y}
                                stroke={isActive ? conn.color : '#E5E7EB'}
                                strokeWidth={isCurrent ? '8' : '4'}
                                strokeDasharray={isCurrent ? '10,5' : '0'}
                                opacity={isActive ? '1' : '0.3'}
                              >
                                {isCurrent && (
                                  <animate
                                    attributeName="stroke-dashoffset"
                                    from="0"
                                    to="15"
                                    dur="0.5s"
                                    repeatCount="indefinite"
                                  />
                                )}
                              </line>
                              
                              {isCurrent && (
                                <circle
                                  r="12"
                                  fill={conn.color}
                                  stroke="white"
                                  strokeWidth="3"
                                >
                                  <animateMotion
                                    dur="2s"
                                    repeatCount="indefinite"
                                    path={`M ${fromServer.x},${fromServer.y} L ${toServer.x},${toServer.y}`}
                                  />
                                </circle>
                              )}
                            </g>
                          );
                        })}

                        {servers.map((server, idx) => {
                          const isHighlighted = step >= 0 && steps[step].serverHighlight === idx;
                          const isPast = step >= 0 && steps.some((s, si) => si < step && s.serverHighlight === idx);
                          const size = server.size === 'large' ? 70 : 60;
                          
                          return (
                            <g key={idx} transform={`translate(${server.x}, ${server.y})`}>
                              {isHighlighted && (
                                <circle
                                  r={size / 2 + 15}
                                  fill="none"
                                  stroke="#FBBF24"
                                  strokeWidth="6"
                                  opacity="0.6"
                                >
                                  <animate
                                    attributeName="r"
                                    values={`${size / 2 + 10};${size / 2 + 20};${size / 2 + 10}`}
                                    dur="1.5s"
                                    repeatCount="indefinite"
                                  />
                                </circle>
                              )}
                              
                              <circle
                                r={size / 2}
                                className={server.color}
                                stroke={isHighlighted ? '#FBBF24' : 'white'}
                                strokeWidth="4"
                                opacity={isPast ? '0.7' : '1'}
                              />
                              
                              {isPast && !isHighlighted && (
                                <text
                                  textAnchor="middle"
                                  dominantBaseline="middle"
                                  fill="white"
                                  fontSize="30"
                                  fontWeight="bold"
                                >
                                  ‚úì
                                </text>
                              )}
                              
                              <text
                                y={size / 2 + 25}
                                textAnchor="middle"
                                fill="#1F2937"
                                fontSize="16"
                                fontWeight="bold"
                              >
                                {server.name}
                              </text>
                            </g>
                          );
                        })}
                      </svg>

                      {step >= 0 && (
                        <div className="absolute bottom-4 left-4 bg-white/90 rounded-lg p-3 shadow-lg">
                          <div className="flex items-center gap-2 text-sm mb-1">
                            <div className="w-4 h-4 rounded-full bg-yellow-400"></div>
                            <span className="font-semibold">Aktiver Schritt</span>
                          </div>
                          <div className="flex items-center gap-2 text-sm mb-1">
                            <div className="w-8 h-1 bg-yellow-500"></div>
                            <span>Anfrage ‚Üí</span>
                          </div>
                          <div className="flex items-center gap-2 text-sm">
                            <div className="w-8 h-1 bg-green-500"></div>
                            <span>Antwort ‚Üê</span>
                          </div>
                        </div>
                      )}

                      {step === 6 && generatedIP && (
                        <div className="absolute top-4 right-4 bg-green-500 text-white rounded-xl p-4 shadow-2xl animate-bounce">
                          <p className="text-xs">IP-Adresse:</p>
                          <p className="font-mono font-bold text-xl">{generatedIP}</p>
                        </div>
                      )}
                    </div>
                  </div>

                  <div className="order-1 md:order-2">
                    {step >= 0 ? (
                      <div className="bg-gradient-to-r from-yellow-400 to-orange-400 rounded-3xl shadow-2xl p-8 border-8 border-yellow-300 h-full">
                        <div className="text-center">
                          <div className="text-8xl mb-4">{steps[step].emoji}</div>
                          <h2 className="text-4xl font-black text-gray-900 mb-3">
                            {steps[step].title}
                          </h2>
                          <p className="text-2xl text-gray-800 font-semibold mb-4">
                            {steps[step].description}
                          </p>
                          <div className="bg-white/90 rounded-2xl p-6">
                            <p className="text-xl text-gray-700 leading-relaxed">
                              {steps[step].detail}
                            </p>
                          </div>
                        </div>
                      </div>
                    ) : (
                      <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 text-center h-full flex flex-col justify-center">
                        <h3 className="text-3xl font-bold text-white mb-6">üí° Anleitung</h3>
                        <div className="space-y-4 text-white text-lg">
                          <div className="bg-white/10 p-4 rounded-xl">
                            <div className="text-4xl mb-2">1Ô∏è‚É£</div>
                            <p>Domain eingeben oder Beispiel w√§hlen</p>
                          </div>
                          <div className="bg-white/10 p-4 rounded-xl">
                            <div className="text-4xl mb-2">2Ô∏è‚É£</div>
                            <p>Auf "Start" klicken</p>
                          </div>
                          <div className="bg-white/10 p-4 rounded-xl">
                            <div className="text-4xl mb-2">3Ô∏è‚É£</div>
                            <p>Schritt f√ºr Schritt folgen</p>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {step >= 0 && (
                  <div className="mt-6 bg-white rounded-2xl shadow-2xl p-6">
                    <h3 className="text-2xl font-bold text-gray-800 mb-4 text-center">Fortschritt</h3>
                    <div className="flex justify-between items-center gap-1">
                      {steps.map((s, idx) => (
                        <div key={idx} className="flex flex-col items-center flex-1">
                          <div className={`w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center font-bold text-lg transition-all duration-500 ${
                            idx < step ? 'bg-green-500 text-white' :
                            idx === step ? 'bg-yellow-400 text-gray-900 scale-125 ring-4 ring-yellow-300 animate-pulse' :
                            'bg-gray-300 text-gray-500'
                          }`}>
                            {idx < step ? '‚úì' : idx + 1}
                          </div>
                          <p className={`text-xs md:text-sm font-semibold mt-1 text-center ${
                            idx === step ? 'text-yellow-400' : 'text-gray-400'
                          }`}>
                            {s.title.split(' ')[1]}
                          </p>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        };

        ReactDOM.render(<DNSVisualization />, document.getElementById('root'));
    </script>
</body>
</html>